
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="cs">
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-2"/>
    <title>Projekt IIS</title>
    <style type="text/css">
        table { border-collapse: collapse; }
        td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
        dt { font-weight: bold; margin-top: 0.5em; }
    </style>
</head>
<body>

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu
     podle pou¾itého editoru -->

<h1>Plánování rozvrhù</h1>

<dl>
    <dt>Autoøi</dt>
    <dd> <b>Nikita Moiseev</b>
        <a href="mailto:xmoise01@stud.fit.vutbr.cz">xmoise01@stud.fit.vutbr.cz</a>
        <ul>
            <li>Vytvoøení efektivní koordinace týmu</li>
            <li>Distribuce úkolù a implementace funkcí vèetnì YouTrack integrace</li>
            <li>Vytvoøení backendu pro entity: Users, Schedule, u¾ivatelské role a pøístupy</li>
            <li>Implementace stranek: Users, Schedule, Student Schedule</li>
        </ul>
    </dd>
    <dd><b>Elena Marochkina</b>
        <a href="mailto:xmaroc00@stud.fit.vutbr.cz">xmaroc00@stud.fit.vutbr.cz</a>
        <ul>
            <li>Vytvoøení zakladní databáze</li>
            <li>Vytvoøení backendu pro entity: Courses, Course-activities, Student-Course</li>
            <li>Implementace stranek: Courses, Courses info</li>
        </ul>
    </dd>
    <dd><b>Nikita Pasynkov</b>
        <a href="mailto:xpasyn00@stud.fit.vutbr.cz">xpasyn00@stud.fit.vutbr.cz</a>
        <ul>
            <li>Implemetace registrace a pøihla¹ení</li>
            <li>Vytvoøení backendu pro entity: Classes, Teacher requirments</li>
            <li>Implementace stranek: Pøihla¹ení, Classes, Teacher requirments</li>
        </ul>
    </dd>
    <dt>URL aplikace</dt>

    <dd> <b>Hlavní odkaz:</b> <a href="http://www.stud.fit.vutbr.cz/~xautor01/IIS">http://www.stud.fit.vutbr.cz/~xautor01/IIS</a></dd>
    <dd> <b>Dal¹í odkaz:</b> <a href="http://www.stud.fit.vutbr.cz/~xautor01/IIS">http://www.stud.fit.vutbr.cz/~xautor01/IIS</a></dd>
</dl>
<h2>U¾ivatelé systému pro testování</h2>
<table>
    <tr><th>Login</th><th>Heslo</th><th>Role</th></tr>
    <tr><td>admin</td><td>password</td><td>ADMIN</td></tr>
    <tr><td>john.smith</td><td>password</td><td>GUARANTOR</td></tr>
    <tr><td>jane.doe</td><td>password</td><td>GUARANTOR</td></tr>
    <tr><td>teacher.one</td><td>password</td><td>TEACHER</td></tr>
    <tr><td>teacher.two</td><td>password</td><td>TEACHER</td></tr>
    <tr><td>teacher.three</td><td>password</td><td>TEACHER</td></tr>
    <tr><td>teacher.four</td><td>password</td><td>TEACHER</td></tr>
    <tr><td>scheduler.one</td><td>password</td><td>SCHEDULER</td></tr>
    <tr><td>student.one</td><td>password</td><td>STUDENT</td></tr>
    <tr><td>student.two</td><td>password</td><td>STUDENT</td></tr>
    <tr><td>student.three</td><td>password</td><td>STUDENT</td></tr>
    <tr><td>student.four</td><td>password</td><td>STUDENT</td></tr>
    <tr><td>student.five</td><td>password</td><td>STUDENT</td></tr>
</table>

<h3>Video</h3>

<p>Pøilo¾te odkaz na komentované video demostrující pou¾ití informaèního systému. Zamìøte se na pøípady u¾ití definované zadáním (napø. registrace u¾ivatele, správa u¾ivatelù a èinnosti jednotlivých rolí). Video nahrajte napøíklad na VUT Google Drive, kde ho bude mo¾né pøímo spustit z odkazu.</p>

<h2>Implementace</h2>
<p>Pro implementaci backendu je pou¾íván framework napsaný v NodeJS s názvem NestJS a ORM knihovna TypeORM. Systémové entity jsou definovány pomocí tøíd a dekorátorù, které specifikují konkrétní pole entit a jejich vlastnosti. Tyto entity jsou následnì propojeny s databází pomocí TypeORM.</p>
    <p>V rámci NestJS je mo¾né vytváøet moduly pro ka¾dou entitu, co¾ zlep¹uje modularitu a pøehlednost kódu. Ka¾dý modul se skládá ze dvou hlavních èástí: servisu a kontroléru.</p>
<ul>
    <li>Servis: Servis je odpovìdný za komunikaci s databází a obsluhuje ve¹kerou logiku spojenou s danou entitou.</li>
    <li>Kontrolér: Kontrolér zaji¹»uje komunikaci mezi frontendem a backendem. Poskytuje koncové body (endpoints) pro pøíjem po¾adavkù a zpracování odpovìdí. Kontroléry delegují logiku zpracování dat na pøíslu¹né slu¾by.</li>
</ul>
<img src="./Service.png" alt="Service">
<p>Tímto zpùsobem je dosa¾eno oddìlení zodpovìdností a strukturování kódu do modulù, co¾ zvy¹uje pøehlednost, udr¾itelnost a efektivitu pøi vývoji.</p>

<h3>Pøístup</h3>
<p>K urèení úrovní pøístupu u¾ivatelù se pou¾ívá systém ABAC (Attribute based access control). Tento vzor má výhody oproti systému RBAC (Role based access control) díky své flexibilitì. Tato výhoda napøíklad umo¾nila pohodlnì implementovat pøístup garantù k editaci kurzù pouze v pøípadì, ¾e se ID garanta shoduje s ID u¾ivatele, který po¾aduje úpravu.</p>
<p>Na základì role u¾ivatele a jeho atributù je diferencován pøístup k zdrojùm a provádìno filtrování. Napøíklad, kdy¾ student po¾aduje prvky rozvrhu, v¹echny prvky jsou filtrovány a vráceny jsou pouze ty, které jsou relevantní pro konkrétního studenta na základì jeho zápisu.</p>

<h3>Rozvrh</h3>
    <p>Rozvrh má od 0 do N záznamù pro ka¾dou aktivitu kurzu. Ka¾dou aktivitu kurzu musí být mo¾né v rozvrhu opakovat. K implementaci této funkce se pou¾ívá pravidlo opakování ze standardu RFC5545 (https://datatracker.ietf.org/doc/html/rfc5545). Tato funkce umo¾òuje nastavit flexibilní pravidla pro opakování urèitého prvku rozvrhu.<p>
<h3>Frontend</h3>
<p>Frontend aplikace vyu¾ívá framework React a knihovny Material UI, react-query, DevExpress a query search.</p>
<ul>
    <li>Material UI: Stylování komponent s vyu¾itím DataGrid pro zobrazení dat z backendu.</li>
    <li>react-query: Komunikace s backendem, vèetnì správy autorizaèního tokenu a ukládání dat do mezipamìti pro offline pou¾ití.</li>
    <li>DevExpress: Zobrazení rozvrhu pomocí flexibilní komponenty Rozvrh.</li>
    <li>query search: Ruènì napsaná knihovna pro flexibilní filtrování dat v ka¾dé komponentì DataGrid podobná dotazovacímu jazyku MongoDB.</li>
</ul>

<h3>Databáze</h3>
    <p>Postgres byl vybrán jako databázový stroj, proto¾e má v¹echny potøebné funkce pro realizaci projektu.</p>
    <img src="./ERD.png" width=100% height="600" alt="ERD">
    <p>Databáze obsahuje celkem 13 entit, z nich¾ 5 slou¾í k definici vztahù typu ManyToMany, zatímco zbylých 8 entit pøedstavuje sémantické komponenty aplikace, jako jsou kurzy, u¾ivatelé, tøídy atd.</p>
        <p>Pou¾ití databázových triggerù je zdùvodnìno snahou udr¾et konzistenci dat v databázi. V pøípadì výskytu chyby pøi provádìní triggerù nedojde k modifikaci dat, která vyvolala spu¹tìní triggerù. Tímto zpùsobem je zaji¹tìna bezpeènost a integrita dat v pøípadì neèekaných událostí.</p>
        <p>Databázové triggery jsou implementovány k tomu, aby se pøede¹lo nekonzistencím a udr¾ela integrita dat. Pøi chybì v provedení triggeru zùstanou data nedotèena, co¾ zabraòuje ne¾ádoucím následkùm. Tato opatøení jsou klíèová pro zaji¹tìní spolehlivosti a stability aplikace pracující s danou databází.</p>

<h2>Instalace</h2>
<p>Projekt se skládá ze tøí vrstev (tier). První vrstvou je databáze. Druhou vrstvou je serverová vrstva (aplikaèní backend). Tøetí vrstva je vrstva klienta (frontend aplikace).</p>
<p>Ka¾dá èást (Tier) aplikace je pøipravena pro osobní pou¾ití pomocí docker kontejnerù.
<p>Aplikace vyu¾ívá tøi kontejnery:</p>

<ul>
    <li>databáze</li>
    <li>backend</li>
    <li>frontend</li>
</ul>
    <p>Celou aplikaci lze spustit pomocí docker compose.<p>
    <p>Ke spu¹tìní databáze staèí zadat obraz aplikace. Kdy¾ spustíte kontejner s databází, obsahuje ji¾ v¹echny potøebné migrace a také pøeddefinovaná data pøidaná pro úèely testování.
        Ke spu¹tìní je tøeba zadat obraz aplikace a také promìnné prostøedí s daty pro pøipojení k databázi a parametry serveru pro aplikaci (datum vypr¹ení platnosti tokenu, klíè generování tokenu atd.).</p>
        <p>Chcete-li spustit frontend, musíte zadat obráz frontendu a také pomocí promìnné prostøedí urèit hostitele, který se má pøipojit k backendu.
        Pøi pou¾ití jednoho souboru docker compose pro v¹echny tøi èásti staèí zadat název kontejneru s backendem.</p>
    <p>Po¾adavky na software: docker >= 4.0.0</p>

<h2>Známé problémy</h2>
<p>V¹echny úkoly byly splnìny.</p>

<h2>Dodateèné informace</h2>
<p>Pøi vývoji aplikace jsme se sna¾ili pokrýt v¹echny po¾adavky na backendu a pøípady pou¾ití na frontendu. Existuje v¹ak riziko neoèekávaného chování.</p>

<p>Chyba by mohla naru¹it testování, úplnì vypnout backend. Aplikace bì¾í v systému Kubernetes DevOPS s obrazy tøí vrstev: databáze, frontendu a backendu. Restart kontejnerù umo¾òuje testování s dostupnými daty. </p>
<p>Pro restart kontejnerù je v horním pravém rohu frontendu tlaèítko nastavení, které umo¾òuje manipulovat s kontejnery bez oprávnìní. Tato metoda by mìla vyøe¹it problémy bìhem testování. </p>
<p>V pøípadì neúspìchu je k dispozici kopie aplikace na jiném serveru na adrese <a href="backup.iis.settler.tech">backup.iis.settler.tech</a>, nezávislém na pùvodním serveru pro testování.</p>

</body>
</html>
